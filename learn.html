<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>小学语文生字学习系统 - 学习页面</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(90deg, #4b6cb7 0%, #182848 100%);
            color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .header-left h1 {
            font-size: 2rem;
            margin-bottom: 5px;
        }
        
        .header-left .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .current-grade {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        .nav-buttons {
            display: flex;
            gap: 15px;
        }
        
        .nav-btn {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }
        
        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .nav-btn.home {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .nav-btn.error {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .section {
            background-color: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            height: fit-content;
        }
        
        .section-title {
            font-size: 1.6rem;
            color: #182848;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #4b6cb7;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            color: #4b6cb7;
        }
        
        /* 左侧生字列表样式 */
        .word-list-container {
            height: 650px;
            overflow-y: auto;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            background-color: #f8f9fa;
            margin-bottom: 20px;
        }
        
        .word-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
            gap: 15px;
        }
        
        .word-item {
            background: white;
            border-radius: 10px;
            padding: 20px 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .word-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            background-color: #f0f5ff;
        }
        
        .word-item.selected {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border: 2px solid #4b6cb7;
        }
        
        .word-item.learned {
            background: linear-gradient(135deg, #d4fc79 0%, #96e6a1 100%);
        }
        
        .character {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .pinyin {
            font-size: 1rem;
            color: #4b6cb7;
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .search-container {
            flex: 1;
            margin-right: 20px;
        }
        
        .search-input {
            width: 100%;
            padding: 12px 15px;
            font-size: 1.1rem;
            border: 2px solid #4b6cb7;
            border-radius: 10px;
        }
        
        .search-input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(75, 108, 183, 0.2);
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        .page-btn {
            padding: 10px 20px;
            background: linear-gradient(135deg, #6a89cc 0%, #4b6cb7 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .page-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .page-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(75, 108, 183, 0.4);
        }
        
        .page-info {
            font-size: 1.1rem;
            color: #666;
        }
        
        /* 右侧生字详情样式 */
        .word-detail-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border-left: 5px solid #4b6cb7;
            height: 100%;
        }
        
        .detail-header {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 30px;
            gap: 30px;
            flex-wrap: wrap;
        }
        
        .detail-character {
            font-size: 6rem;
            font-weight: bold;
            color: #182848;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.1);
        }
        
        .detail-pinyin {
            font-size: 2.5rem;
            color: #4b6cb7;
            font-weight: bold;
            padding: 15px 25px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .detail-content {
            text-align: center;
        }
        
        .detail-meaning {
            font-size: 1.5rem;
            color: #444;
            line-height: 1.8;
            margin-bottom: 25px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }
        
        .detail-example {
            font-size: 1.3rem;
            color: #4b6cb7;
            font-weight: 500;
            padding: 15px 25px;
            background-color: rgba(75, 108, 183, 0.1);
            border-radius: 12px;
            display: inline-block;
            margin-bottom: 15px;
        }
        
        .word-stroke {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
        }
        
        .stroke-title {
            font-size: 1.3rem;
            color: #182848;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .stroke-image {
            text-align: center;
            margin: 20px 0;
        }
        
        .stroke-dots {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        
        .stroke-row {
            display: flex;
            gap: 5px;
        }
        
        .stroke-dot {
            width: 30px;
            height: 30px;
            background: #4b6cb7;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .stroke-dot.active {
            background: #f5576c;
            transform: scale(1.1);
        }
        
        .stroke-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }
        
        .stroke-btn {
            padding: 8px 15px;
            background: #4b6cb7;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .stroke-btn:hover {
            background: #3a5ca9;
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }
        
        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            color: #ccc;
        }
        
        .empty-state h3 {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: #666;
        }
        
        .empty-state p {
            font-size: 1.2rem;
            line-height: 1.6;
        }
        
        .stats-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }
        
        .stats-card .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .stats-card .stat-label {
            font-size: 1rem;
            opacity: 0.9;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #666;
            font-size: 0.9rem;
            border-top: 1px solid #e0e0e0;
        }
        
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .header-left, .header-right {
                width: 100%;
            }
            
            .nav-buttons {
                justify-content: center;
            }
            
            .controls {
                flex-direction: column;
                gap: 15px;
            }
            
            .search-container {
                margin-right: 0;
                width: 100%;
            }
            
            .detail-header {
                flex-direction: column;
                gap: 15px;
            }
            
            .detail-character {
                font-size: 4rem;
            }
            
            .detail-pinyin {
                font-size: 1.8rem;
            }
            
            .word-list {
                grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-left">
                <h1>小学语文生字学习系统</h1>
                <p class="subtitle">生字词学习页面</p>
            </div>
            <div class="current-grade" id="current-grade">
                年级加载中...
            </div>
            <div class="header-right">
                <div class="nav-buttons">
                    <a href="index.html" class="nav-btn home">
                        <i class="fas fa-home"></i> 首页
                    </a>
                    <a href="errors.html" class="nav-btn error">
                        <i class="fas fa-exclamation-triangle"></i> 易错字
                    </a>
                </div>
            </div>
        </header>
        
        <div class="main-content">
            <div class="section">
                <h2 class="section-title"><i class="fas fa-list"></i> 生字列表</h2>
                
                <div class="controls">
                    <div class="search-container">
                        <input type="text" class="search-input" id="search-input" placeholder="搜索生字...">
                    </div>
                    <div class="page-info" id="words-count">共 0 个生字</div>
                </div>
                
                <div class="word-list-container">
                    <div class="word-list" id="word-list">
                        <!-- 生字列表会在这里动态生成 -->
                    </div>
                </div>
                
                <div class="pagination">
                    <button class="page-btn" id="prev-page">
                        <i class="fas fa-chevron-left"></i> 上一页
                    </button>
                    <div class="page-info">
                        第 <span id="current-page">1</span> 页 / 共 <span id="total-pages">1</span> 页
                    </div>
                    <button class="page-btn" id="next-page">
                        下一页 <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                
                <div class="stats-card">
                    <div class="stat-value" id="learned-count">0</div>
                    <div class="stat-label">已学习生字</div>
                </div>
            </div>
            
            <div class="section">
                <h2 class="section-title"><i class="fas fa-info-circle"></i> 生字详情</h2>
                
                <div class="word-detail-card" id="word-detail-card">
                    <div class="empty-state" id="empty-state">
                        <i class="fas fa-search"></i>
                        <h3>请选择生字</h3>
                        <p>点击左侧生字卡片查看详细信息</p>
                    </div>
                    
                    <div id="word-detail-content" style="display: none;">
                        <div class="detail-header">
                            <div class="detail-character" id="detail-character">?</div>
                            <div class="detail-pinyin" id="detail-pinyin">pinyin</div>
                        </div>
                        <div class="detail-content">
                            <div class="detail-meaning" id="detail-meaning">释义加载中...</div>
                            <div class="detail-example" id="detail-example">例词加载中...</div>
                        </div>
                        
                        <div class="word-stroke">
                            <div class="stroke-title">笔画顺序演示</div>
                            <div class="stroke-image" id="stroke-image">
                                <!-- 笔画顺序会动态生成 -->
                            </div>
                            <div class="stroke-controls">
                                <button class="stroke-btn" id="prev-stroke">上一步</button>
                                <button class="stroke-btn" id="next-stroke">下一步</button>
                                <button class="stroke-btn" id="reset-stroke">重置</button>
                            </div>
                            <div class="stroke-count" id="stroke-count" style="text-align: center; color: #666; font-size: 1.1rem; margin-top: 15px;">
                                笔画数：加载中...
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="stats-card">
                    <div class="stat-value" id="total-words">0</div>
                    <div class="stat-label">本年级总生字数</div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>© 2023 小学语文生字学习系统 | 当前年级：<span id="footer-grade">一年级上册</span></p>
            <p style="margin-top: 5px; font-size: 0.85rem;">数据来源：部编人教版小学语文教材</p>
        </footer>
    </div>

    <script>
        // 完整的生字数据库（包含1-6年级上下册所有生字）
        // 由于数据量巨大，这里只展示结构，实际使用时需要补充完整数据
        const wordDatabase = {
            // 一年级上册
            "1-1": {
                name: "一年级上册",
                characters: ["一", "二", "三", "十", "木", "禾", "上", "下", "土", "个", "八", "入", "大", "天", "人", "火", "文", "六", "七", "儿", "九", "无", "口", "日", "中", "了", "子", "门", "月", "不", "开", "四", "五", "目", "耳", "头", "米", "见", "白", "田", "电", "也", "长", "山", "出", "飞", "马", "鸟", "云", "公", "车", "牛", "羊", "小", "少", "巾", "牙", "尺", "毛", "卜", "又", "心", "风", "力", "手", "水", "广", "升", "足", "走", "方", "半", "巴", "业", "本", "平", "书", "自", "已", "东", "西", "回", "片", "皮", "生", "里", "果", "几", "用", "鱼", "今", "正", "雨", "两", "瓜", "衣", "来", "年", "左", "右"],
                data: {
                    "一": {
                        pinyin: "yī",
                        meaning: "数目字，最小的正整数",
                        example: "一个、一年级",
                        strokes: 1,
                        strokeOrder: ["一"]
                    },
                    "二": {
                        pinyin: "èr",
                        meaning: "数目字，一加一的和",
                        example: "二月、第二",
                        strokes: 2,
                        strokeOrder: ["一", "一"]
                    },
                    "三": {
                        pinyin: "sān",
                        meaning: "数目字，二加一的和",
                        example: "三月、三心二意",
                        strokes: 3,
                        strokeOrder: ["一", "一", "一"]
                    },
                    "十": {
                        pinyin: "shí",
                        meaning: "数目字，九加一的和",
                        example: "十月、十分",
                        strokes: 2,
                        strokeOrder: ["一", "丨"]
                    },
                    "木": {
                        pinyin: "mù",
                        meaning: "树类植物的通称",
                        example: "树木、木马",
                        strokes: 4,
                        strokeOrder: ["一", "丨", "丿", "乀"]
                    }
                    // ... 其他生字数据需要补充完整
                }
            },
            // 一年级下册
            "1-2": {
                name: "一年级下册",
                characters: ["万", "丁", "冬", "百", "齐", "说", "话", "朋", "友", "春", "高", "你", "们", "红", "绿", "花", "草", "爷", "节", "岁", "亲", "的", "行", "古", "声", "多", "处", "知", "忙", "洗", "认", "扫", "真", "父", "母", "爸", "全", "关", "写", "完", "家", "看", "笑", "着", "兴", "画", "会", "妈", "奶", "午", "合", "放", "收", "女", "太", "气", "早", "去", "亮", "和", "语", "千", "李", "秀", "香", "听", "唱", "连", "远", "定", "向", "以", "后", "更", "主", "意", "总", "先", "起", "干", "明", "净", "同", "工", "专", "才", "级", "队", "蚂", "蚁", "前", "空", "房", "网", "诗", "林", "童", "黄", "闭", "立", "是", "朵", "美", "我", "叶", "机", "她", "他", "送", "过", "时", "让", "吗", "吧", "虫", "往", "得", "很", "河", "姐", "借", "呢", "呀", "哪", "谁", "怕", "跟", "凉", "量", "最", "园", "因", "为", "脸", "阳", "光", "可", "石", "办", "法", "找", "许", "别", "到", "那", "都", "吓", "叫", "再", "做", "象", "点", "照", "沙", "海", "桥", "竹", "军", "苗", "井", "乡", "面", "忘", "想", "念", "王", "这", "从", "进", "边", "道", "贝", "男", "原", "爱", "虾", "跑", "吹", "乐", "地", "老", "快", "师", "短", "淡", "对", "热", "冷", "情", "拉", "把", "给", "活", "种", "吃", "练", "学", "习", "非", "苦", "常", "问", "伴", "间", "共", "伙", "汽", "分", "要", "没", "孩", "位", "选", "北", "南", "江", "湖", "秋", "只", "星", "雪", "帮", "请", "就", "球", "玩", "跳", "桃", "树", "刚", "兰", "各", "坐", "座", "带", "急", "名", "发", "成", "晚", "动", "新", "有", "在", "什", "么", "变", "条"],
                data: {
                    "万": {
                        pinyin: "wàn",
                        meaning: "数目，十个一千",
                        example: "万一、万里",
                        strokes: 3,
                        strokeOrder: ["一", "㇆", "丿"]
                    },
                    "丁": {
                        pinyin: "dīng",
                        meaning: "天干的第四位，成年男子",
                        example: "园丁、丁字",
                        strokes: 2,
                        strokeOrder: ["一", "亅"]
                    },
                    "冬": {
                        pinyin: "dōng",
                        meaning: "一年四季的第四季",
                        example: "冬天、冬季",
                        strokes: 5,
                        strokeOrder: ["丿", "㇇", "㇏", "丶", "丶"]
                    },
                    "百": {
                        pinyin: "bǎi",
                        meaning: "数名，十个十",
                        example: "百姓、百货",
                        strokes: 6,
                        strokeOrder: ["一", "丿", "丨", "𠃍", "一", "一"]
                    },
                    "齐": {
                        pinyin: "qí",
                        meaning: "东西的一头平或排成一条直线",
                        example: "整齐、齐心",
                        strokes: 6,
                        strokeOrder: ["丶", "一", "丿", "㇏", "丿", "丨"]
                    }
                    // ... 其他生字数据需要补充完整
                }
            },
            // 二年级上册
            "2-1": {
                name: "二年级上册",
                characters: ["宜", "实", "色", "华", "谷", "金", "尽", "层", "丰", "壮", "波", "浪", "灯", "作", "字", "苹", "丽", "劳", "尤", "其", "区", "巨", "它", "安", "块", "站", "已", "甲", "豆", "识", "纷", "经", "如", "好", "娃", "洼", "于", "首", "枝", "枫", "记", "刘", "胡", "戏", "棋", "钢", "观", "弹", "琴", "养", "休", "伸", "甜", "歌", "院", "除", "息", "您", "牵", "困", "员", "青", "宁", "室", "样", "校", "切", "教", "响", "班", "欠", "元", "包", "钟", "叹", "哈", "迟", "闹", "及", "身", "仔", "细", "次", "外", "计", "怦", "礼", "加", "夕", "与", "川", "州", "台", "争", "民", "族", "亿", "洁", "欢", "祖", "旗", "帜", "庆", "曲", "央", "交", "市", "旁", "优", "阴", "坛", "城", "国", "图", "申", "匹", "互", "京", "泪", "洋", "拥", "抱", "相", "扬", "讲", "打", "指", "接", "惊", "故", "候", "奇", "寸", "落", "补", "拔", "功", "助", "取", "所", "信", "沿", "拾", "际", "蛙", "错", "答", "还", "言", "每", "治", "棵", "挂", "哇", "怪", "慢", "怎", "思", "穿", "弯", "比", "服", "浅", "漂", "啦", "啊", "夫", "表", "示", "号", "汗", "伤", "吸", "极", "串", "兔", "告", "诉", "狐", "狸", "猴", "颗", "斤", "折", "挑", "根", "独", "满", "容", "易", "采", "背", "板", "椅", "但", "傍", "清", "消", "由", "术", "吐", "注", "课", "铅", "笔", "桌", "景", "拿", "坏", "松", "扎", "抓", "祝", "福", "句", "幸", "之", "令", "布", "直", "当", "第", "现", "期", "轮", "路", "丑", "永", "饥", "饱", "温", "贫", "富", "户", "亚", "角", "周", "床", "病", "始", "张", "寻", "哭", "良", "食", "双", "体", "操", "场", "份", "粉", "昨", "晴", "姑", "娘", "妹", "读", "舟", "乘", "音", "客", "何", "汪", "丛", "牢", "拍", "护", "保", "物", "鸡", "猫", "羽", "领", "捉", "理", "跃", "蹦", "灵", "晨", "失", "觉", "扔", "掉", "眼", "睛", "纸", "船", "久", "乎", "至", "死", "腰", "捡", "粒", "被", "并", "夜", "喜", "重", "味", "轻", "刻", "群", "卫", "运", "宇", "宙", "航", "舰", "冲", "晒", "池", "浮", "灾", "害", "黑", "器", "岸", "纹", "洞", "影", "倒", "游", "圆", "围", "杯", "件", "住", "须", "能", "飘", "必", "事", "历", "史", "灭", "克", "化", "代", "孙", "植", "厂", "产", "介", "农", "科", "技", "纺", "织"],
                data: {
                    "宜": {
                        pinyin: "yí",
                        meaning: "适合，适当",
                        example: "适宜、便宜",
                        strokes: 8,
                        strokeOrder: ["丶", "丶", "㇇", "一", "丿", "㇏", "一", "一"]
                    },
                    "实": {
                        pinyin: "shí",
                        meaning: "充满，符合客观情况",
                        example: "实在、实际",
                        strokes: 8,
                        strokeOrder: ["丶", "丶", "㇇", "丶", "丶", "一", "丿", "丶"]
                    },
                    "色": {
                        pinyin: "sè",
                        meaning: "颜色，由物体发射、反射的光通过视觉而产生的印象",
                        example: "色彩、颜色",
                        strokes: 6,
                        strokeOrder: ["丿", "㇇", "丶", "丨", "𠃊", "乚"]
                    }
                    // ... 其他生字数据需要补充完整
                }
            }
            // ... 其他年级数据需要补充完整
        };

        // 应用状态
        let appState = {
            currentGrade: "1-1",
            selectedWord: null,
            learnedWords: new Set(),
            searchQuery: "",
            currentPage: 1,
            pageSize: 48,
            filteredWords: [],
            strokeStep: 0,
            strokeTimer: null
        };

        // DOM元素
        const wordListElement = document.getElementById('word-list');
        const searchInput = document.getElementById('search-input');
        const currentGradeElement = document.getElementById('current-grade');
        const footerGradeElement = document.getElementById('footer-grade');
        
        // 详情元素
        const detailCharacterElement = document.getElementById('detail-character');
        const detailPinyinElement = document.getElementById('detail-pinyin');
        const detailMeaningElement = document.getElementById('detail-meaning');
        const detailExampleElement = document.getElementById('detail-example');
        const wordDetailContent = document.getElementById('word-detail-content');
        const emptyState = document.getElementById('empty-state');
        const strokeImageElement = document.getElementById('stroke-image');
        const strokeCountElement = document.getElementById('stroke-count');
        
        // 分页元素
        const prevPageButton = document.getElementById('prev-page');
        const nextPageButton = document.getElementById('next-page');
        const currentPageElement = document.getElementById('current-page');
        const totalPagesElement = document.getElementById('total-pages');
        const wordsCountElement = document.getElementById('words-count');
        
        // 统计元素
        const totalWordsElement = document.getElementById('total-words');
        const learnedCountElement = document.getElementById('learned-count');
        
        // 笔画控制元素
        const prevStrokeButton = document.getElementById('prev-stroke');
        const nextStrokeButton = document.getElementById('next-stroke');
        const resetStrokeButton = document.getElementById('reset-stroke');

        // 初始化应用
        function initApp() {
            console.log("初始化学习页面...");
            
            // 从URL参数或本地存储获取年级
            const urlParams = new URLSearchParams(window.location.search);
            const gradeFromUrl = urlParams.get('grade');
            const gradeFromStorage = localStorage.getItem('selectedGrade');
            
            appState.currentGrade = gradeFromUrl || gradeFromStorage || "1-1";
            
            // 从本地存储加载已学习的字
            loadLearnedWords();
            
            // 初始化事件监听
            initEventListeners();
            
            // 加载生字列表
            loadWordList();
            
            // 更新统计信息
            updateStatistics();
            
            // 更新年级显示
            updateGradeDisplay();
            
            console.log("学习页面初始化完成，年级：" + appState.currentGrade);
        }

        // 从本地存储加载已学习的字
        function loadLearnedWords() {
            const savedLearnedWords = localStorage.getItem('learnedWords');
            if (savedLearnedWords) {
                try {
                    const parsedWords = JSON.parse(savedLearnedWords);
                    appState.learnedWords = new Set(parsedWords);
                } catch (e) {
                    console.error("加载已学习字词失败:", e);
                    appState.learnedWords = new Set();
                }
            }
        }

        // 保存已学习的字到本地存储
        function saveLearnedWords() {
            const wordsArray = Array.from(appState.learnedWords);
            localStorage.setItem('learnedWords', JSON.stringify(wordsArray));
        }

        // 初始化事件监听
        function initEventListeners() {
            // 搜索框输入事件
            searchInput.addEventListener('input', function() {
                appState.searchQuery = this.value.trim();
                appState.currentPage = 1; // 搜索时重置到第一页
                loadCurrentPage();
                updatePaginationButtons();
            });
            
            // 上一页按钮
            prevPageButton.addEventListener('click', function() {
                if (appState.currentPage > 1) {
                    appState.currentPage--;
                    loadCurrentPage();
                    updatePaginationButtons();
                }
            });
            
            // 下一页按钮
            nextPageButton.addEventListener('click', function() {
                const totalPages = Math.ceil(appState.filteredWords.length / appState.pageSize);
                if (appState.currentPage < totalPages) {
                    appState.currentPage++;
                    loadCurrentPage();
                    updatePaginationButtons();
                }
            });
            
            // 笔画控制按钮
            prevStrokeButton.addEventListener('click', showPrevStroke);
            nextStrokeButton.addEventListener('click', showNextStroke);
            resetStrokeButton.addEventListener('click', resetStrokes);
        }

        // 更新年级显示
        function updateGradeDisplay() {
            const gradeData = wordDatabase[appState.currentGrade];
            if (!gradeData) {
                currentGradeElement.textContent = "年级信息错误";
                footerGradeElement.textContent = "年级信息错误";
                return;
            }
            
            currentGradeElement.textContent = gradeData.name;
            footerGradeElement.textContent = gradeData.name;
            
            // 更新页面标题
            document.title = `小学语文生字学习系统 - ${gradeData.name}`;
        }

        // 加载生字列表
        function loadWordList() {
            const gradeData = wordDatabase[appState.currentGrade];
            if (!gradeData) {
                console.error("未找到该年级的生字数据");
                return;
            }
            
            // 获取生字列表
            const characters = gradeData.characters || [];
            
            // 过滤生字（根据搜索查询）
            if (appState.searchQuery) {
                const query = appState.searchQuery.toLowerCase();
                appState.filteredWords = characters.filter(char => {
                    const charData = gradeData.data[char];
                    if (!charData) return false;
                    
                    return char.includes(query) || 
                           charData.pinyin.toLowerCase().includes(query) ||
                           charData.meaning.toLowerCase().includes(query) ||
                           charData.example.toLowerCase().includes(query);
                });
            } else {
                appState.filteredWords = [...characters];
            }
            
            // 更新字数统计
            const totalWords = characters.length;
            wordsCountElement.textContent = `共 ${appState.filteredWords.length} 个生字`;
            totalWordsElement.textContent = totalWords;
            
            // 计算总页数
            const totalPages = Math.ceil(appState.filteredWords.length / appState.pageSize);
            
            // 更新分页信息
            currentPageElement.textContent = appState.currentPage;
            totalPagesElement.textContent = totalPages;
            
            // 加载当前页
            loadCurrentPage();
            
            // 更新分页按钮状态
            updatePaginationButtons();
            
            // 更新已学习数量
            updateLearnedCount();
        }

        // 加载当前页
        function loadCurrentPage() {
            // 清空当前列表
            wordListElement.innerHTML = '';
            
            if (appState.filteredWords.length === 0) {
                wordListElement.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <i class="fas fa-search"></i>
                        <h3>没有找到匹配的生字</h3>
                        <p>请尝试其他搜索关键词</p>
                    </div>
                `;
                return;
            }
            
            // 计算当前页的起始和结束索引
            const startIndex = (appState.currentPage - 1) * appState.pageSize;
            const endIndex = Math.min(startIndex + appState.pageSize, appState.filteredWords.length);
            
            // 生成当前页的生字列表
            for (let i = startIndex; i < endIndex; i++) {
                const character = appState.filteredWords[i];
                const gradeData = wordDatabase[appState.currentGrade];
                const charData = gradeData.data[character];
                
                if (!charData) continue;
                
                const isLearned = appState.learnedWords.has(character);
                const isSelected = appState.selectedWord === character;
                
                const wordItem = document.createElement('div');
                wordItem.className = `word-item ${isLearned ? 'learned' : ''} ${isSelected ? 'selected' : ''}`;
                wordItem.innerHTML = `
                    <div class="character">${character}</div>
                    <div class="pinyin">${charData.pinyin}</div>
                `;
                
                // 点击生字查看详情
                wordItem.addEventListener('click', function() {
                    selectWord(character);
                });
                
                wordListElement.appendChild(wordItem);
            }
        }

        // 选择生字
        function selectWord(character) {
            // 移除所有选中状态
            document.querySelectorAll('.word-item').forEach(item => {
                item.classList.remove('selected');
            });
            
            // 添加选中样式到对应生字
            document.querySelectorAll('.word-item').forEach(item => {
                if (item.querySelector('.character').textContent === character) {
                    item.classList.add('selected');
                }
            });
            
            // 更新选中状态
            appState.selectedWord = character;
            
            // 显示生字详情
            showWordDetail(character);
            
            // 标记为已学习
            if (!appState.learnedWords.has(character)) {
                appState.learnedWords.add(character);
                
                // 更新对应生字卡片样式
                document.querySelectorAll('.word-item').forEach(item => {
                    if (item.querySelector('.character').textContent === character) {
                        item.classList.add('learned');
                    }
                });
                
                saveLearnedWords();
                updateStatistics();
            }
        }

        // 更新分页按钮状态
        function updatePaginationButtons() {
            const totalPages = Math.ceil(appState.filteredWords.length / appState.pageSize);
            
            // 更新上一页按钮状态
            prevPageButton.disabled = appState.currentPage <= 1;
            
            // 更新下一页按钮状态
            nextStrokeButton.disabled = appState.currentPage >= totalPages;
            
            // 更新分页信息
            currentPageElement.textContent = appState.currentPage;
            totalPagesElement.textContent = totalPages;
        }

        // 显示生字详情
        function showWordDetail(character) {
            const gradeData = wordDatabase[appState.currentGrade];
            if (!gradeData) return;
            
            const charData = gradeData.data[character];
            if (!charData) return;
            
            // 显示详情内容，隐藏空状态
            wordDetailContent.style.display = 'block';
            emptyState.style.display = 'none';
            
            // 更新详情内容
            detailCharacterElement.textContent = character;
            detailPinyinElement.textContent = charData.pinyin;
            detailMeaningElement.textContent = charData.meaning;
            detailExampleElement.textContent = `例词：${charData.example}`;
            
            // 更新笔画数
            strokeCountElement.textContent = `笔画数：${charData.strokes}`;
            
            // 显示笔画顺序
            displayStrokeOrder(character, charData);
        }

        // 显示笔画顺序
        function displayStrokeOrder(character, charData) {
            appState.strokeStep = 0;
            clearInterval(appState.strokeTimer);
            
            const strokes = charData.strokes || 1;
            const strokeOrder = charData.strokeOrder || Array(strokes).fill("丶");
            
            // 创建笔画显示区域
            strokeImageElement.innerHTML = '';
            
            // 创建笔画点阵
            const rows = Math.ceil(strokes / 5);
            const strokeDots = document.createElement('div');
            strokeDots.className = 'stroke-dots';
            
            for (let row = 0; row < rows; row++) {
                const rowDiv = document.createElement('div');
                rowDiv.className = 'stroke-row';
                
                for (let col = 0; col < 5; col++) {
                    const index = row * 5 + col;
                    if (index >= strokes) break;
                    
                    const dot = document.createElement('div');
                    dot.className = 'stroke-dot';
                    dot.textContent = strokeOrder[index] || "丶";
                    dot.dataset.index = index;
                    
                    rowDiv.appendChild(dot);
                }
                
                strokeDots.appendChild(rowDiv);
            }
            
            strokeImageElement.appendChild(strokeDots);
            
            // 自动演示笔画顺序
            appState.strokeTimer = setInterval(() => {
                if (appState.strokeStep < strokes) {
                    highlightStroke(appState.strokeStep);
                    appState.strokeStep++;
                } else {
                    clearInterval(appState.strokeTimer);
                    setTimeout(() => {
                        resetStrokes();
                        appState.strokeTimer = setInterval(() => {
                            if (appState.strokeStep < strokes) {
                                highlightStroke(appState.strokeStep);
                                appState.strokeStep++;
                            } else {
                                clearInterval(appState.strokeTimer);
                            }
                        }, 500);
                    }, 1000);
                }
            }, 500);
        }

        // 高亮当前笔画
        function highlightStroke(index) {
            const dots = strokeImageElement.querySelectorAll('.stroke-dot');
            dots.forEach(dot => {
                dot.classList.remove('active');
                if (parseInt(dot.dataset.index) === index) {
                    dot.classList.add('active');
                }
            });
        }

        // 显示上一步笔画
        function showPrevStroke() {
            if (appState.strokeStep > 0) {
                appState.strokeStep--;
                highlightStroke(appState.strokeStep);
            }
        }

        // 显示下一步笔画
        function showNextStroke() {
            const gradeData = wordDatabase[appState.currentGrade];
            if (!gradeData) return;
            
            const charData = gradeData.data[appState.selectedWord];
            if (!charData) return;
            
            const strokes = charData.strokes || 1;
            if (appState.strokeStep < strokes) {
                highlightStroke(appState.strokeStep);
                appState.strokeStep++;
            }
        }

        // 重置笔画演示
        function resetStrokes() {
            const dots = strokeImageElement.querySelectorAll('.stroke-dot');
            dots.forEach(dot => {
                dot.classList.remove('active');
            });
            appState.strokeStep = 0;
        }

        // 更新统计信息
        function updateStatistics() {
            // 更新已学习数量
            updateLearnedCount();
        }

        // 更新已学习数量
        function updateLearnedCount() {
            const gradeData = wordDatabase[appState.currentGrade];
            if (!gradeData) return;
            
            const characters = gradeData.characters || [];
            const learnedInGrade = characters.filter(char => appState.learnedWords.has(char)).length;
            learnedCountElement.textContent = learnedInGrade;
        }

        // 页面加载完成后初始化应用
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>